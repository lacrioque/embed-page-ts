"use strict";function e(e,t){e.appendChild(t)}class t extends HTMLElement{skipSourceRefresh;static get observedAttributes(){return["src"]}updateContent(t){this.shadowRoot&&(this.shadowRoot.innerHTML='\n<style>.loader {border: 16px solid #f3f3f3;border-top: 16px solid #3498db;border-radius: 50%;width: 120px;height: 120px;animation: spin 2s linear infinite;} @keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style>\n<div style="height: 50vh; width: 90vw; margin: 4vw; display: flex; align-items: center; justify-content: center;">\n  <div class="loader"></div> \n</div>\n',t.then((t=>function(t,r){const s=(new DOMParser).parseFromString(r,"text/html"),o=s.head,n=s.body,i=Array.from(s.head.getElementsByTagName("script")),a=s.head.getElementsByTagName("link"),h=Array.from(a).filter((e=>"stylesheet"===e.rel)),c=Array.from(s.head.getElementsByTagName("style")),d=Array.from(s.body.getElementsByTagName("script")),l=Array.from(s.body.getElementsByTagName("style"));!function(e){for(const t of e)t.parentNode&&t.parentNode.removeChild(t)}([...i,...h,...c,...d,...l]),t.innerHTML="<html></html>",t.firstChild?.appendChild(o),t.firstChild?.appendChild(n),i.forEach((t=>e(o,t))),h.forEach((t=>e(o,t))),c.forEach((t=>e(o,t))),d.forEach((t=>e(n,t))),l.forEach((t=>e(n,t)))}(this.shadowRoot,t))))}getContent(){const e=fetch(this.getAttribute("src"),{credentials:"same-origin",redirect:"follow",mode:"same-origin",cache:"default"}).then((e=>e.text()));this.updateContent(e)}getContentByForm(e,t,r){this.skipSourceRefresh=!0,this.setAttribute("src",e);const s=new URLSearchParams([...r.entries()]),o=new URL(this.getAttribute("src"));s.forEach(((e,t)=>{o.searchParams.append(t,e)}));const n=fetch(o,{credentials:"same-origin",redirect:"follow",mode:"same-origin",cache:"default",method:t,body:r}).then((e=>e.text()));this.updateContent(n)}postForNewContentByForm(e,t,r){this.skipSourceRefresh=!0,this.setAttribute("src",e);const s=fetch(this.getAttribute("src"),{credentials:"same-origin",redirect:"follow",mode:"same-origin",cache:"default",method:t,body:new URLSearchParams([...r.entries()]),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then((e=>e.text()));this.updateContent(s)}constructor(){super();const e=this.attachShadow({mode:"open"});e.addEventListener("click",(e=>{const t=e.target?.getAttribute("href");t&&this.setAttribute("src",t)})),e.addEventListener("submit",(e=>{e.preventDefault();const t=e.target,r=new FormData(t),s=t.method||"GET";["POST","PATCH","PUT"].includes(s)&&this.postForNewContentByForm(t.target||this.getAttribute("src"),s,r),["GET","DELETE"].includes(s)&&this.getContentByForm(t.target||this.getAttribute("src"),s,r)})),this.skipSourceRefresh=!1}connectedCallback(){this.getContent()}attributeChangeCallback(){!1===this.skipSourceRefresh&&this.getContent(),this.skipSourceRefresh=!1}}module.exports=function(){try{window.customElements.define("embed-page",t)}catch(e){console.error("Could not create webcomponent: ",e)}};
